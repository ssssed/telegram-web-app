import{j as s,u,h as x,r as i,s as _}from"./index-3e243a46.js";import{u as d,a as g,b as p}from"./axios-e620c505.js";const j=()=>window.Telegram.WebApp,N=({children:a})=>{const t=j(),c=()=>t.close();return s.jsxs("div",{className:"empty",children:[s.jsx("span",{children:a}),s.jsx("button",{onClick:c,children:"Закрыть приложение"})]})};const v=({avatar:a,name:t,text:c,counter:e})=>s.jsxs("div",{className:"message",children:[s.jsxs("div",{className:"message__head",children:[s.jsx("img",{className:"message__img",src:a,alt:t}),s.jsx("p",{className:"message__name",children:t})]}),s.jsxs("div",{className:"message__content",children:[s.jsx("p",{className:"message__text",children:c}),s.jsx("div",{className:"message__counter",children:e})]})]}),C=({id:a,title:t,user_name:c,user_avatar:e,message:n,message_count:r,onClick:l})=>s.jsxs("div",{className:"card",children:[s.jsx("p",{className:"card__status",children:"Есть непрочитанные сообщения"}),s.jsxs("ul",{className:"card__info",children:[s.jsxs("li",{className:"card__category",children:["Вакансия: ",t]}),s.jsxs("li",{className:"card__category",children:["# ",a]})]}),s.jsx(v,{name:c,avatar:e,text:n,counter:r}),s.jsx("button",{className:"card__button",onClick:l,children:"Открыть диалог"})]}),f=a=>{const t=u(),c=d(),{id:e,message:n,message_count:r,title:l,user_avatar:o,user_name:m}=a,h=()=>{c(x(a)),t(`/chat/${a.id}`)};return s.jsx(C,{id:e,title:l,message_count:r,message:n,user_name:m,user_avatar:o,onClick:h})},A=()=>{const a=d(),{cards:t}=g(e=>e.chat);if(!t.length)return s.jsx(N,{children:"У вас нет непрочитанных сообщений"});const c=i.useCallback(async()=>{const{data:e}=await p.post("http://localhost:8000/v1/api/dialogs",{user_name:"",user_id:""});e.status===200&&a(_(e.messages))},[]);return i.useEffect(()=>{c()},[c]),s.jsx("div",{className:"cards",children:t.map(e=>s.jsx(f,{...e},e.id))})};export{A as default};
