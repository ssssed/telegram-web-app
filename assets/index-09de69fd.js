import{j as e,r as d,u as g,a as N,s as v}from"./index-bdf24465.js";import{u as x,a as p}from"./useReduxToolkit-03cf2dc3.js";const y=a=>{const t=a.getHours(),s=a.getMinutes();return`${t}:${s}`};const C=({avatar:a,name:t,order:s,onClick:n})=>e.jsxs("div",{className:"chat-header",children:[e.jsx("img",{className:"chat-header__img",src:a}),e.jsxs("div",{className:"chat-header__info",children:[e.jsx("h3",{className:"chat-header__title",children:t}),e.jsxs("p",{className:"chat-header__text",children:["работает над заявкой ",s]})]}),e.jsx("button",{className:"chat-header__button",onClick:n,children:"Вернуться"})]}),b="/telegram-web-app/assets/clip-55921f01.svg";const M=({onChange:a})=>{const t=d.useRef(null),s=()=>{var n;t&&((n=t.current)==null||n.click())};return e.jsxs("div",{className:"chat-file",children:[e.jsx("input",{type:"file",onChange:a,ref:t,style:{display:"none"}}),e.jsx("img",{className:"chat-file__img",onClick:s,src:b,alt:"clip"})]})};const $=({file_name:a,message:t,className:s,children:n})=>e.jsxs("div",{className:`chat-message chat-message${s}`,children:[e.jsxs("div",{className:"chat-message__info",children:[e.jsx("p",{className:"chat-message__text",children:t}),e.jsx("span",{className:"chat-message__file-name",children:a})]}),n]});const k=({children:a,onClick:t})=>e.jsx("button",{className:"chat-message__button",onClick:t,children:a}),_=({children:a,prefix:t,time:s})=>e.jsxs("div",{className:"chat-message__status",children:[e.jsx("span",{className:`chat-message__time chat-message__time${t}`,children:s}),a]}),F=()=>{const a=g(),t=x(),s=()=>{t(N()),a("/")},{selectedChat:n}=p(c=>c.chat);return e.jsx(C,{avatar:n.user_avatar,name:n.user_name,order:n.title,onClick:s})},w="/telegram-web-app/assets/close-dd15b66d.svg",D="_container_1tye2_1",S="_file_1tye2_9",W="_content_1tye2_16",I="_input_1tye2_27",H="_send_1tye2_36",R="_close_1tye2_45",A="_img_1tye2_53",l={container:D,file:S,content:W,input:I,send:H,close:R,img:A},E=()=>{const[a,t]=d.useState(""),[s,n]=d.useState(null),c=x(),i=r=>t(r.target.value),u=r=>{var m;const o=(m=r.target.files)==null?void 0:m.item(0);o&&n(o)},j=()=>n(null),f=async r=>{r.preventDefault();const o=y(new Date),m={message:a,time:o,author:"user"},h=new FormData;s&&(h.append("file",s),h.append("originalName",s.name),m.file_name=s.name),h.append("message",a),h.append("time",o),h.append("author","user"),c(v(m)),t(""),n(null)};return e.jsxs("form",{className:l.container,onSubmit:f,children:[e.jsxs("div",{className:l.content,children:[s&&e.jsxs("div",{className:l.file,children:[e.jsx("span",{children:s.name}),e.jsx("div",{className:l.close,children:e.jsx("img",{src:w,className:l.img,alt:"close",onClick:j})})]}),e.jsx("input",{className:l.input,placeholder:"Напишите сообщение",value:a,onChange:i}),e.jsx(M,{onChange:u})]}),e.jsx("button",{type:"submit",className:l.send,children:"Отправить"})]})},B="/telegram-web-app/assets/checkmark-1f343b7b.svg",P=({hasFile:a,isMyMessage:t,prefix:s,time:n,message:c})=>{const i=g(),u=()=>i(`/file/${c.file_name}`);return a?e.jsx(k,{onClick:u,children:"Посмотреть файл"}):t?e.jsx(_,{prefix:s,time:n,children:e.jsx("img",{className:"chat-message__img",src:B,alt:"checkmark"})}):e.jsx(_,{prefix:s,time:n})};const T=d.memo(()=>{const{messages:a}=p(s=>s.chat),{selectedChat:t}=p(s=>s.chat);return e.jsx("div",{className:"messages",children:a.map(s=>{const n=s.author!==t.user_name,c=!!s.file_name,i=n?"_my":"_intervier";return e.jsx($,{className:i,message:s.message,author:s.author,time:s.time,file_name:s.file_name,children:e.jsx(P,{prefix:i,message:s,time:s.time,isMyMessage:n,hasFile:c})},s.time)})})});const G=()=>e.jsxs("div",{className:"chat",children:[e.jsx(F,{}),e.jsx("hr",{color:"#d9d9d9"}),e.jsx(T,{}),e.jsx(E,{})]});export{G as default};
